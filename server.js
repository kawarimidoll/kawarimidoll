// This script is generated by https://deno.land/x/deploy_dir@v0.3.2
import { decode } from "https://deno.land/std@0.97.0/encoding/base64.ts";
import { gunzip } from "https://raw.githubusercontent.com/kt3k/compress/bbe0a818d2acd399350b30036ff8772354b1c2df/gzip/gzip.ts";
console.log("init");
const dirData = {};
dirData["/index.html"] = [decode("H4sIAAAAAAAAA61Z23LbNhD9FZSePjUkJdV2XOritkkmaZs0aZNMJ810MksSEmEBBAqAusTjfnsXJCVLMh2ZkV5saxc4OGd3sQDkwTdPXz959+HNM5JZwUeD+ieFdDQQ1AJJMtCG2qFX2LF/4dXWHAQdejNG50pq65FE5pbmOGrOUpsNUzpjCfXLD49YziwD7psEOB12gw6CWGY5HU1hDpoJlkrOB2FlGxi7xF+xTJfXKTOKwzIac7roXxXGsvHSr5eKEvxBdV+AnrA86vQtXVgfOJvkK5dJNAL7Mc1gxqSOjJDSZjdwXQ5NaSI1WCbzKJc5vcl61xWWH3OZTH1jQdvI72kq+lsOmqe4nII0ZfnEt1JFpzjmhonJmnA5cE2NQGHlzYkAll+XIYm6nc636F5UEYouOh21WCFGXUQjneDMgQYwA+RxHUudUu1rSFlhojOcnVE2yWxUQgecGetPtCzU9S3qWYm6TaIaySwVu5A4tLaUCYiM5CxdmSpAm7F8jVfyK0HXxGtbrySew8yP5eI6hmTqmOUpZo5jFk7G43FfScPK0GNOk+my76LYWa0WS2uliLpqQUoW5KTX65WIX64IowCLDsrFtnXvUOw3ZuF7F69ymRFsZ/JmEFZVOeAsnxJN+dBjuKpH7FLhPmACJjQ0s8l3C8E9kmk6HnqZtcpEYahhHkyYzYq4MFTXXINEinCz/Lc/CDBYwCEY3Hlm7fqUZEx9cgsHuBbuorDap26vjAYpmxGWDj1XZujDciTAcUdWFeSRamd6vfMObleO0Lcuo5NbvpXR3MO5CC+6p+cXj88vZ8NTXCbr7uxiNJRUyoA5NtXOqVLqSsMb/cQEsZLElADJsDyoJpCn+EEhddQdDEJEKGFGTzjWhxt9VQgVBBuulYi60LxdIxqgTsWJ0nLMODV1XLb0unhOdAAiHFOwGYbdCBzrQnxp2Gc67J17VSRLuws7bEBbKfkDcd3QBlhn3kV1dfZAVDe0AdWZd1FNoVy7fiDwhI1tA7Az18BVLu5k5LYbuQLplVV5UAZOO7sZyHp3V3Rd7WHwiSo2hK3A0eo11O6qhdw5X7zRWzm2WPuU4HlHuVRUfzEkDydoEmaMxE14l+XK1ZLqB5gSg+fg0ShyNqZ+XMhlA8e1ryXJvzJKObZXls/QIo9F1WoG+WRrS6+Yrlwtif6Sp1JqpMNEfLSIWo03C3elKFQj07W3JdmX0l1TqBbExdUcL64ClK9Y3kC29rQk+qeUgnQ73UfkV1CQb7Gs28hXd9t1C1l128M6iJB4qZW6SXrlaSldQPL67bGaB65mVYZ32qb2sXa2ZMjeuEkHUjRMKE7DnMoZE03sNv0tCf5eTjoOwZTm8n56ztuS3FOc0lTPX33On3Z2znlXz7Bz9bRzZt19avey6R3UpmrQhhZVeVqG5l01ays6m7eWFZPqPnpcLTXmXSmVo6WS58y+KOK9QhRb0IBD+OPxZGiWNolAc0sJb5Abh70SPtM8D/DSc7xMxFJOGyQ4c0sJfyO3vQL+ZczCcWvJUNBJ1tQ1SkdLFX84gntlzOfzIC6WgkIix2NKj6uoxmy4KZeOlop+LpZEuCdfNXuvtk0ZTtdhO4TLuElJaW8p5NWSGFyZfCzyFJ+uuJaxukjc1xn/PKSLcTh+F3OYjV0MHe272EuIyUdjgdP9glwJ5kpcmVLTf0cTpSCZwqQpZ7WnpSzkeK+m+jA+5Hl82tl5HjedxwU+FnB2FSrcA+klPouFfCJTOnR2v3d1lrIfpo/jzlfFrr6frJe59wazGtEyhu9xGnmG80jJ21U8ln9KI7LDfv8ZmARCKrUMrlSI4HoZ4tsEBQYqU5fVn0P9/rfHFJ8DB5WRq0PQvkEZDeHY8LZtAo49KZnCRhxWnPcGYKwZd+JTOc+5hPSwoydDNu5tGMOkKekb7rZPMpgWAu7qfP7ilT29I3Lrc/WtZFj+Q+F/KYWIU2YYAAA="), "text/html", '"2eaa3a625a5d0ce1f7fa085b8e8188c9"', "private"];
addEventListener("fetch", (e) => {
  let { pathname } = new URL(e.request.url);
  if (pathname.endsWith("/")) {
    pathname += "index.html";
  }
  let data = dirData[pathname];
  if (!data) {
    data = dirData[pathname + '.html'];
  }
  if (data) {
    const [bytes, mediaType, etag, cacheControl] = data;
    const acceptsGzip = e.request.headers.get("accept-encoding")?.split(/[,;]s*/).includes("gzip");
    if (e.request.headers.get("if-none-match") === etag) {
      e.respondWith(new Response(null, { status: 304, statusText: "Not Modified" }));
      return;
    }
    if (acceptsGzip) {
      e.respondWith(new Response(bytes, { headers: {
        etag,
	"cache-control": cacheControl,
        "content-type": mediaType,
        "content-encoding": "gzip",
      } }));
    } else {
      e.respondWith(new Response(gunzip(bytes), { headers: {
        etag,
	"cache-control": cacheControl,
        "content-type": mediaType
      } }));
    }
    return;
  }
  e.respondWith(new Response("404 Not Found", { status: 404 }));
});